@model Product
@{
	ViewData["Title"] = "Product Details";
}

<div class="container mt-5">
	<div class="card mx-auto shadow-lg border-0" style="max-width: 900px; border-radius: 18px;">

		<div class="row g-0">
			<!-- Image Column -->
			<div class="col-md-5">
				<img src="~/images/@Model.ImageUrl"
					 class="img-fluid rounded-start w-100"
					 alt="@Model.Name"
					 style="height:100%; max-height:420px; object-fit:cover;" />
			</div>

			<div class="col-md-7">
				<div class="card-body d-flex flex-column h-100">

					<!-- Product Info -->
					<div>
						<h2 class="fw-bold mb-2">@Model.Name</h2>

						@if (!string.IsNullOrEmpty(Model.Description))
						{
							<p class="text-muted">@Model.Description</p>
						}

						<div class="mb-3">
							<span class="badge bg-success fs-6 me-2">
								💰 @Model.Price.ToString("C")
							</span>

							<span class="badge bg-info fs-6">
								📦 Stock: @Model.Stock
							</span>
						</div>

						<!-- Ingredients -->
						@if (Model.ProductIngerdients != null && Model.ProductIngerdients.Any())
						{
							<div class="mt-4">
								<h5 class="fw-bold mb-2">🧪 Ingredients</h5>
								<ul class="list-group list-group-flush">
									@foreach (var item in Model.ProductIngerdients)
									{
										<li class="list-group-item px-0">
											• @item.Ingredient.Name
										</li>
									}
								</ul>
							</div>
						}
					</div>

					<!-- Buttons -->
					<div class="mt-auto pt-4 d-flex justify-content-between align-items-center">
						<a asp-action="Index" class="btn btn-outline-secondary">
							<i class="fa fa-arrow-left"></i> Back
						</a>

						<div class="d-flex gap-2">

							@if (User.Identity.IsAuthenticated)
							{
								<a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary">
									<i class="fa fa-edit"></i>
								</a>

								<button type="button" class="btn btn-danger"
										onclick="confirmDelete(@Model.Id)">
									<i class="fa fa-trash"></i>
								</button>
							}
							<a href="/Cart/AddToCart?id=@Model.Id"
							   class="btn btn-success flex-fill rounded-pill">
								<i class="fa fa-cart-plus"></i> Add to Cart
							</a>
						</div>
					</div>

				</div>
			</div>
		</div>

	</div>
</div>

@section Scripts {
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<script>
		function confirmDelete(id) {
			Swal.fire({
				title: 'Are you sure?',
				text: "This product will be permanently deleted!",
				icon: 'warning',
				showCancelButton: true,
				confirmButtonColor: '#d33',
				cancelButtonColor: '#6c757d',
				confirmButtonText: 'Yes, delete it',
				cancelButtonText: 'Cancel'
			}).then((result) => {
				if (result.isConfirmed) {
					window.location.href = `/Product/Delete/${id}`;
				}
			});
		}
	</script>
}
